# 创建文件夹
mkdir -p /home/animation
mkdir -p /home/gdrive
mkdir -p /home/vip
mkdir -p /home/Anime
# 安装fclone
chmod +x /usr/bin/fclone
fclone --version

# 复制配置挂载
cat > /root/.config/rclone/rclone.conf <<EOF
[cp]
type = drive
scope = drive
service_account_file = /home/ubuntu/cp/001ebf73805a04b7a812d93556bc83c4466a8fdf.json
service_account_file_path = /home/ubuntu/cp/
EOF

# 设置fclone挂载
cat > /root/.config/rclone/rclone.conf <<EOF
[anime]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n217@saintforce1p11.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0AIBQ3xN_7rCsUk9PVA

[emby]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n1000@saintforce1p50.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0ALWY01GA2U0mUk9PVA

[movies]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n109@saintforce1p6.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0APEshgEbmf0uUk9PVA

[vip]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n117@saintforce1p6.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0ABT4IeyuBR6nUk9PVA
EOF

fclone mount anime: /home/Anime --umask 0000 --default-permissions --allow-non-empty --allow-other --buffer-size 32M --dir-cache-time 12h --vfs-read-chunk-size 64M --vfs-read-chunk-size-limit 1G &
fclone mount emby: /home/animation --umask 0000 --default-permissions --allow-non-empty --allow-other --buffer-size 32M --dir-cache-time 12h --vfs-read-chunk-size 64M --vfs-read-chunk-size-limit 1G &
fclone mount movies: /home/gdrive --umask 0000 --default-permissions --allow-non-empty --allow-other --buffer-size 32M --dir-cache-time 12h --vfs-read-chunk-size 64M --vfs-read-chunk-size-limit 1G &
fclone mount vip: /home/vip --umask 0000 --default-permissions --allow-non-empty --allow-other --buffer-size 32M --dir-cache-time 12h --vfs-read-chunk-size 64M --vfs-read-chunk-size-limit 1G &

# 新番盘设置自动挂载
cat > /etc/systemd/system/anime.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/Anime
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount anime: /home/Anime  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/Anime
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# 动画盘设置自动挂载
cat > /etc/systemd/system/rclone.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/animation
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount emby: /home/animation  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/animation
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# Jmsooo盘设置自动挂载
cat > /etc/systemd/system/jmsooo.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/gdrive
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount movies: /home/gdrive  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/gdrive
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# vip盘设置自动挂载
cat > /etc/systemd/system/vip.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/vip
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount vip: /home/vip  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/vip
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# 设置开机启动
systemctl start rclone jmsooo vip anime
systemctl enable rclone jmsooo vip anime

# 查看状态
systemctl status rclone
systemctl status jmsooo
systemctl status vip
systemctl status anime

# 暂停服务
systemctl stop rclone
systemctl stop jmsooo
systemctl stop vip
systemctl stop anime
