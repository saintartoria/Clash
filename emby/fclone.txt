# 创建文件夹
mkdir -p /home/film /home/domestic /home/documentary /home/asia /home/american /home/animation /home/vip /home/Anime /home/music
mkdir -p /home/domestic
mkdir -p /home/documentary
mkdir -p /home/asia
mkdir -p /home/american
mkdir -p /home/animation
mkdir -p /home/gdrive
mkdir -p /home/vip
mkdir -p /home/Anime
mkdir -p /home/music



apt-get install fuse
# 安装fclone

bash <(wget -qO- https://git.io/JJYE0)
chmod +x /usr/bin/fclone
fclone --version

# 设置fclone挂载
[TVseries]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n74@saintforce1p4.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0ACd6fg9EnFwfUk9PVA

[movies]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n48@saintforce1p3.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0AGUoHxaV1Lr4Uk9PVA


cat > /root/.config/rclone/rclone.conf <<EOF
[emby]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n7@saintforce1p1.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0ALWY01GA2U0mUk9PVA

[anime]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n32@saintforce1p2.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0AA41xOkUIlAQUk9PVA

[vip]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n65@saintforce1p4.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0ABT4IeyuBR6nUk9PVA

[music]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n86@saintforce1p5.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0APB-ngSE6izMUk9PVA

[film]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n22@saintforce1p2.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0APMaNVB5ISosUk9PVA

[domestic]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n30@saintforce1p2.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0AJYuGJ-NjGQ1Uk9PVA

[documentary]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n42@saintforce1p3.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0APhFFcA9g8aNUk9PVA

[asia]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n69@saintforce1p4.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0AH9LCfYXgjLKUk9PVA

[american]
type = drive
scope = drive
service_account_file = /home/ubuntu/sa/saintforce1n74@saintforce1p4.iam.gserviceaccount.com.json
service_account_file_path = /home/ubuntu/sa/
team_drive = 0AKg7y4cTDmcVUk9PVA
EOF



# 动画盘设置自动挂载
cat > /etc/systemd/system/rclone.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/Anime
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount emby: /home/Anime  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/Anime
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# 新番盘设置自动挂载
cat > /etc/systemd/system/anime.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/animation
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount anime: /home/animation  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/animation
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# Jmsooo盘设置自动挂载
cat > /etc/systemd/system/jmsooo.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/gdrive
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount movies: /home/gdrive  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/gdrive
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# vip盘设置自动挂载
cat > /etc/systemd/system/vip.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/vip
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount vip: /home/vip  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/vip
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# american盘设置自动挂载
cat > /etc/systemd/system/american.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/american
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount american: /home/american  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/american
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# domestic盘设置自动挂载
cat > /etc/systemd/system/domestic.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/domestic
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount domestic: /home/domestic  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/domestic
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# film盘设置自动挂载
cat > /etc/systemd/system/film.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/film
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount film: /home/film  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/film
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# documentary盘设置自动挂载
cat > /etc/systemd/system/documentary.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/documentary
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount documentary: /home/documentary  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/documentary
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# asia盘设置自动挂载
cat > /etc/systemd/system/asia.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/asia
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount asia: /home/asia  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/asia
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# music盘设置自动挂载
cat > /etc/systemd/system/music.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/music
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount music: /home/music  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/music
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

# 剧集盘设置自动挂载
cat > /etc/systemd/system/TVseries.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/TVseries
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount TVseries: /home/TVseries  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 32M  --dir-cache-time 12h  --vfs-read-chunk-size 64M  --vfs-read-chunk-size-limit 1G
ExecStop=/bin/fusermount -u /home/TVseries
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF

cat > /etc/systemd/system/download.service <<EOF
[Unit]
Description=Rclone
AssertPathIsDirectory=/home/qb/downloads
After=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/fclone mount download: /home/qb/downloads  --umask 0000  --default-permissions  --allow-non-empty  --allow-other  --buffer-size 256M --dir-cache-time 24h  --vfs-read-chunk-size 512M  --vfs-read-chunk-size-limit 4G
ExecStop=/bin/fusermount -u /home/qb/downloads
Restart=on-abort
User=root

[Install]
WantedBy=default.target
EOF


cat > /etc/systemd/system/qbittorrent-nox.service <<EOF
[Unit]
Description=qBittorrent Daemon Service
After=network.target

[Service]
#UMask=000
Type=forking
LimitNOFILE=infinity
ExecStart=/usr/bin/qbittorrent-nox -d –webui-port=8080
ExecStop=/usr/bin/killall -s 9 /usr/bin/qbittorrent-nox
Restart=on-failure
#TimeoutSec=300

[Install]
WantedBy=multi-user.target
EOF


# 设置开机启动
systemctl start TVseries rclone vip anime film domestic documentary asia american music jmsooo
systemctl enable TVseries rclone vip anime film domestic documentary asia american music jmsooo

# 查看状态
systemctl status rclone
systemctl status jmsooo
systemctl status vip
systemctl status anime

# 暂停服务
systemctl stop rclone
systemctl stop jmsooo
systemctl stop vip
systemctl stop anime
